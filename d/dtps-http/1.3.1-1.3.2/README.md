# Comparing `tmp/dtps_http-1.3.1-py3-none-any.whl.zip` & `tmp/dtps_http-1.3.2-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,46 +1,41 @@
-Zip file size: 158534 bytes, number of entries: 44
+Zip file size: 151401 bytes, number of entries: 39
 -rw-r--r--  2.0 unx      235 b- defN 80-Jan-01 00:00 dtps/__init__.py
 -rw-r--r--  2.0 unx     6709 b- defN 80-Jan-01 00:00 dtps/config.py
 -rw-r--r--  2.0 unx    11921 b- defN 80-Jan-01 00:00 dtps/ergo_create.py
 -rw-r--r--  2.0 unx     7597 b- defN 80-Jan-01 00:00 dtps/ergo_ui.py
 -rw-r--r--  2.0 unx    12744 b- defN 80-Jan-01 00:00 dtps/ergo_use.py
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 dtps/py.typed
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 dtps/structures.py
 -rw-r--r--  2.0 unx      655 b- defN 80-Jan-01 00:00 dtps_http/__init__.py
 -rw-r--r--  2.0 unx     4860 b- defN 80-Jan-01 00:00 dtps_http/blob_manager.py
--rw-r--r--  2.0 unx    62746 b- defN 80-Jan-01 00:00 dtps_http/client.py
--rw-r--r--  2.0 unx     3576 b- defN 80-Jan-01 00:00 dtps_http/constants.py
+-rw-r--r--  2.0 unx    62792 b- defN 80-Jan-01 00:00 dtps_http/client.py
+-rw-r--r--  2.0 unx     3721 b- defN 80-Jan-01 00:00 dtps_http/constants.py
 -rw-r--r--  2.0 unx     1365 b- defN 80-Jan-01 00:00 dtps_http/ergo_utils.py
 -rw-r--r--  2.0 unx      420 b- defN 80-Jan-01 00:00 dtps_http/exceptions.py
 -rw-r--r--  2.0 unx     1672 b- defN 80-Jan-01 00:00 dtps_http/link_headers.py
--rw-r--r--  2.0 unx    10357 b- defN 80-Jan-01 00:00 dtps_http/object_queue.py
+-rw-r--r--  2.0 unx    10426 b- defN 80-Jan-01 00:00 dtps_http/object_queue.py
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 dtps_http/py.typed
 -rw-r--r--  2.0 unx    75035 b- defN 80-Jan-01 00:00 dtps_http/server.py
 -rw-r--r--  2.0 unx     9695 b- defN 80-Jan-01 00:00 dtps_http/server_start.py
 -rw-r--r--  2.0 unx    17307 b- defN 80-Jan-01 00:00 dtps_http/structures.py
 -rw-r--r--  2.0 unx     3555 b- defN 80-Jan-01 00:00 dtps_http/types.py
--rw-r--r--  2.0 unx    21400 b- defN 80-Jan-01 00:00 dtps_http/types_of_source.py
+-rw-r--r--  2.0 unx    21464 b- defN 80-Jan-01 00:00 dtps_http/types_of_source.py
 -rw-r--r--  2.0 unx     4336 b- defN 80-Jan-01 00:00 dtps_http/urls.py
 -rw-r--r--  2.0 unx     6139 b- defN 80-Jan-01 00:00 dtps_http/utils.py
 -rw-r--r--  2.0 unx      838 b- defN 80-Jan-01 00:00 dtps_http/utils_every_once_in_a_while.py
 -rw-r--r--  2.0 unx      257 b- defN 80-Jan-01 00:00 dtps_http_programs/__init__.py
 -rw-r--r--  2.0 unx     3671 b- defN 80-Jan-01 00:00 dtps_http_programs/dtps_listen.py
 -rw-r--r--  2.0 unx     1721 b- defN 80-Jan-01 00:00 dtps_http_programs/dtps_proxy.py
 -rw-r--r--  2.0 unx     1338 b- defN 80-Jan-01 00:00 dtps_http_programs/dtps_send_continuous.py
 -rw-r--r--  2.0 unx     3112 b- defN 80-Jan-01 00:00 dtps_http_programs/dtps_stats.py
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 dtps_http_programs/py.typed
 -rw-r--r--  2.0 unx     1789 b- defN 80-Jan-01 00:00 dtps_http_programs/server_clock.py
--rw-r--r--  2.0 unx     1886 b- defN 80-Jan-01 00:00 dtps_http_programs/test_hashes.py
--rw-r--r--  2.0 unx     4682 b- defN 80-Jan-01 00:00 dtps_http_programs/test_memory.py
--rw-r--r--  2.0 unx     3267 b- defN 80-Jan-01 00:00 dtps_http_programs/test_memory_dashboard.py
--rw-r--r--  2.0 unx     2988 b- defN 80-Jan-01 00:00 dtps_http_programs/test_memory_dashboard_just_push.py
--rw-r--r--  2.0 unx     5257 b- defN 80-Jan-01 00:00 dtps_http_programs/test_memory_use.py
 -rw-r--r--  2.0 unx     1270 b- defN 80-Jan-01 00:00 static/favicon.png
 -rw-r--r--  2.0 unx     7885 b- defN 80-Jan-01 00:00 static/send.js
 -rw-r--r--  2.0 unx     1472 b- defN 80-Jan-01 00:00 static/style.css
--rw-r--r--  2.0 unx    75933 b- defN 80-Jan-01 00:00 dtps_http-1.3.1.dist-info/LICENSE.pdf
--rw-r--r--  2.0 unx     1040 b- defN 80-Jan-01 00:00 dtps_http-1.3.1.dist-info/METADATA
--rw-r--r--  2.0 unx       88 b- defN 80-Jan-01 00:00 dtps_http-1.3.1.dist-info/WHEEL
--rw-r--r--  2.0 unx      379 b- defN 80-Jan-01 00:00 dtps_http-1.3.1.dist-info/entry_points.txt
-?rw-r--r--  2.0 unx     3595 b- defN 16-Jan-01 00:00 dtps_http-1.3.1.dist-info/RECORD
-44 files, 384792 bytes uncompressed, 152862 bytes compressed:  60.3%
+-rw-r--r--  2.0 unx    75933 b- defN 80-Jan-01 00:00 dtps_http-1.3.2.dist-info/LICENSE.pdf
+-rw-r--r--  2.0 unx     1040 b- defN 80-Jan-01 00:00 dtps_http-1.3.2.dist-info/METADATA
+-rw-r--r--  2.0 unx       88 b- defN 80-Jan-01 00:00 dtps_http-1.3.2.dist-info/WHEEL
+-rw-r--r--  2.0 unx      379 b- defN 80-Jan-01 00:00 dtps_http-1.3.2.dist-info/entry_points.txt
+?rw-r--r--  2.0 unx     3111 b- defN 16-Jan-01 00:00 dtps_http-1.3.2.dist-info/RECORD
+39 files, 366552 bytes uncompressed, 146507 bytes compressed:  60.0%
```

## zipnote {}

```diff
@@ -87,47 +87,32 @@
 
 Filename: dtps_http_programs/py.typed
 Comment: 
 
 Filename: dtps_http_programs/server_clock.py
 Comment: 
 
-Filename: dtps_http_programs/test_hashes.py
-Comment: 
-
-Filename: dtps_http_programs/test_memory.py
-Comment: 
-
-Filename: dtps_http_programs/test_memory_dashboard.py
-Comment: 
-
-Filename: dtps_http_programs/test_memory_dashboard_just_push.py
-Comment: 
-
-Filename: dtps_http_programs/test_memory_use.py
-Comment: 
-
 Filename: static/favicon.png
 Comment: 
 
 Filename: static/send.js
 Comment: 
 
 Filename: static/style.css
 Comment: 
 
-Filename: dtps_http-1.3.1.dist-info/LICENSE.pdf
+Filename: dtps_http-1.3.2.dist-info/LICENSE.pdf
 Comment: 
 
-Filename: dtps_http-1.3.1.dist-info/METADATA
+Filename: dtps_http-1.3.2.dist-info/METADATA
 Comment: 
 
-Filename: dtps_http-1.3.1.dist-info/WHEEL
+Filename: dtps_http-1.3.2.dist-info/WHEEL
 Comment: 
 
-Filename: dtps_http-1.3.1.dist-info/entry_points.txt
+Filename: dtps_http-1.3.2.dist-info/entry_points.txt
 Comment: 
 
-Filename: dtps_http-1.3.1.dist-info/RECORD
+Filename: dtps_http-1.3.2.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## dtps/__init__.py

```diff
@@ -1,8 +1,8 @@
-__version__ = "1.3.1"
+__version__ = "1.3.2"
 
 from logging import DEBUG, getLogger
 
 logger = getLogger(__name__)
 logger.setLevel(DEBUG)
 
 from .config import *
```

## dtps_http/__init__.py

```diff
@@ -1,8 +1,8 @@
-__version__ = "1.3.1"
+__version__ = "1.3.2"
 
 import coloredlogs  # type: ignore
 
 coloredlogs.install(level="DEBUG")  # type: ignore
 
 from logging import getLogger, INFO, WARNING
```

## dtps_http/client.py

```diff
@@ -406,14 +406,15 @@
             return None
         results: List[str] = []
         possible: List[Tuple[float, float, float, U]] = []
         for a, expects_answer_from in us:
             assert isinstance(a, URL), a
             if (score := await self.can_use_url(a, expects_answer_from)) is not None:
                 possible.append((score.complexity, score.latency_ns, -score.bandwidth, a))
+                # TODO: 60 is a magic number?
                 results.append(f"✓ {str(a):<60} -> {score}")
             else:
                 results.append(f"✗ {a} ")
 
         possible.sort(key=lambda x: (x[0], x[1]))
         if not possible:
             rs = "\n".join(results)
```

## dtps_http/constants.py

```diff
@@ -45,14 +45,15 @@
     "TOPIC_CLOCK",
     "TOPIC_CONNECTIONS",
     "TOPIC_LIST",
     "TOPIC_LOGS",
     "TOPIC_PROXIED",
     "TOPIC_STATE_NOTIFICATION",
     "TOPIC_STATE_SUMMARY",
+    "DEFAULT_DATA_AVAILABILITY_TIMEOUT"
 ]
 
 HEADER_NO_CACHE = {
     "Cache-Control": "no-store, must-revalidate, max-age=0, post-check=0, pre-check=0",
     "Pragma": "no-cache",
     "Expires": "0",
 }
@@ -106,7 +107,8 @@
 MIME_OCTET = ContentType("application/octet-stream")
 
 ENV_MASK_ORIGIN = "DTPS_HTTP_MASK_ORIGIN"
 
 HTTP_TIMEOUT: float = float(os.environ.get("DTPS_HTTP_TIMEOUT", "10"))
 
 DEFAULT_MAX_HISTORY: int = 10
+DEFAULT_DATA_AVAILABILITY_TIMEOUT: float = float(os.environ.get("DTPS_DATA_AVAILABILITY_TIMEOUT", "60"))
```

## dtps_http/object_queue.py

```diff
@@ -10,14 +10,15 @@
 from . import logger
 from .blob_manager import BlobManager
 from .constants import (
     MIME_CBOR,
     MIME_JSON,
     MIME_TEXT,
     MIME_YAML,
+    DEFAULT_DATA_AVAILABILITY_TIMEOUT,
 )
 from .structures import (
     Bounds,
     ChannelInfo,
     ChannelInfoDesc,
     Clocks,
     DataReady,
@@ -258,16 +259,15 @@
         key, callback = self.listeners.pop(sub_id)
         try:
             await self._sub.remove_listener(key, callback)
         except Exception as e:
             logger.error(f"Could not unsubscribe {sub_id}: {e}")
 
     def get_data_ready(self, ds: DataSaved, inline_data: bool) -> DataReady:
-
-        available_interval = 60
+        available_interval = DEFAULT_DATA_AVAILABILITY_TIMEOUT
         available_until = time.time() + available_interval
         content = self.blob_manager.get_blob(ds.digest)
         actual_url = self.blob_manager.get_use_once_link_store(
             ds.digest, content, ds.content_type, available_interval
         )
         # available_until = self.blob_manager.extend_deadline(ds.digest, available_interval)
```

## dtps_http/types_of_source.py

```diff
@@ -7,15 +7,15 @@
 import aiohttp
 import cbor2
 import jsonpatch
 from aiohttp import ClientResponse, web
 from jsonpatch import JsonPatch
 
 from . import logger
-from .constants import CONTENT_TYPE_DTPS_INDEX_CBOR, CONTENT_TYPE_PATCH_CBOR
+from .constants import CONTENT_TYPE_DTPS_INDEX_CBOR, CONTENT_TYPE_PATCH_CBOR, DEFAULT_DATA_AVAILABILITY_TIMEOUT
 from .object_queue import PostResult, TransformError
 from .structures import (
     Bounds,
     ContentInfo,
     DataReady,
     DataSaved,
     LinkBenchmark,
@@ -364,15 +364,15 @@
     locations = resp_data.headers.getall("location")
 
     dr = DataReady.from_data_saved(ds)
     for location in locations:
         url = join(base_url, location)
 
         rd = await client.get(url, accept=ds.content_type)
-        availability_s = 60.0
+        availability_s = DEFAULT_DATA_AVAILABILITY_TIMEOUT
         available_until = time.time() + availability_s
 
         the_url = server.blob_manager.get_use_once_link_store(
             dr.digest, rd.content, dr.content_type, availability_s
         )
 
         dr.availability.append(ResourceAvailability(url=the_url, available_until=available_until))
```

## dtps_http_programs/__init__.py

```diff
@@ -1,8 +1,8 @@
-__version__ = "1.3.1"
+__version__ = "1.3.2"
 
 from logging import DEBUG, getLogger
 
 logger = getLogger(__name__)
 logger.setLevel(DEBUG)
 
 from .server_clock import *
```

## Comparing `dtps_http-1.3.1.dist-info/LICENSE.pdf` & `dtps_http-1.3.2.dist-info/LICENSE.pdf`

 * *Files identical despite different names*

## Comparing `dtps_http-1.3.1.dist-info/METADATA` & `dtps_http-1.3.2.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: dtps-http
-Version: 1.3.1
+Version: 1.3.2
 Summary: 
 Author: Andrea Censi
 Author-email: AndreaCensi@users.noreply.github.com
 Requires-Python: >=3.8,<4.0
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
```

## Comparing `dtps_http-1.3.1.dist-info/RECORD` & `dtps_http-1.3.2.dist-info/RECORD`

 * *Files 19% similar despite different names*

```diff
@@ -1,44 +1,39 @@
-dtps/__init__.py,sha256=En6BEKyFIcSP1KK9_SYnMhSP7mr52SC5z7a8jIdR6XA,235
+dtps/__init__.py,sha256=0YALX99EIrbvScQbCix3U5M6pZm7NmaPBdVy_wYx4Ag,235
 dtps/config.py,sha256=pX8NyQFRER6sxKxiCCNW7rTjUR2lQyg7yi-wcTzwlDA,6709
 dtps/ergo_create.py,sha256=awaOjfX8eVBzK_y2us3WcOTxiS3v3j7XqTVf55UKPk4,11921
 dtps/ergo_ui.py,sha256=lnP4ChQcc2hQkOxDDQEj_FG_SQc2aCEiICEPtRL2dSI,7597
 dtps/ergo_use.py,sha256=lZJg0Pd1mj-bbRqlcB06ebEpQ5L0wkHF1QyvvURnI4k,12744
 dtps/py.typed,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 dtps/structures.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-dtps_http/__init__.py,sha256=P3Yl5XJudr1S23w_POIYVYCPHqGjBbS2t7_rVyhiLYA,655
+dtps_http/__init__.py,sha256=fdRk2Q0ArOnOyA_PTObwnR7S4p_6ZOGfA9Giy5FC7x4,655
 dtps_http/blob_manager.py,sha256=cHg_4nU1_X7KjBUK6meX0pZkEJ8MCzOw6k1gh1DefzM,4860
-dtps_http/client.py,sha256=gdQF6n3u44i977uwbMf46zWGNKE6usk0ABYY7chC_7M,62746
-dtps_http/constants.py,sha256=1p5-Jywj4SvV4WR-Krx7agOjhHCbbt8cKiD3Ng_n-_8,3576
+dtps_http/client.py,sha256=8EK9BTLr03ycKHoxzB0_K44D325EZpIvvTZXlalznF0,62792
+dtps_http/constants.py,sha256=iWSaL75cxZI62Q1oWqzLl9vAK_aaUgBQarFf3bChbbc,3721
 dtps_http/ergo_utils.py,sha256=tVW797yywqleDm9f0yoo8pZXHk5yb-8gr3j9yJQjakI,1365
 dtps_http/exceptions.py,sha256=4w-Yrx-MedOytS_QIpNCiIZRQbFTjyjID-MO-JL_skw,420
 dtps_http/link_headers.py,sha256=ADp5tF-pKU1N7W3M4SISASYTTisL086lTHKYpwDPEo0,1672
-dtps_http/object_queue.py,sha256=u7Qjn47RaCzv-PJubiufsRj_wTI0sZkp44C7EbWPRi8,10357
+dtps_http/object_queue.py,sha256=MzAERV5fgwtxrFCOwASljEY0rQHaYJwfxoBl4RapHII,10426
 dtps_http/py.typed,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 dtps_http/server.py,sha256=mSpRgPfFTnMjWCDHOE1h91luSm3rJs-Y2V1aORg7NLM,75035
 dtps_http/server_start.py,sha256=fK1pNHPveSCeEw8AV5M6WfVqKHz4nyq4xW1tP9JZCtI,9695
 dtps_http/structures.py,sha256=wjq_7U4Zn9V1h9yJgpZ82ssU6hHgw84miyafCWun4ps,17307
 dtps_http/types.py,sha256=0izHqzwhIqABEFg6lPuf9-fzu8VvxjsukOOlepl9nhQ,3555
-dtps_http/types_of_source.py,sha256=qpq--U-xBYPWPKpGN1z8wq_uOk0oLBahW9Voz-A2NF0,21400
+dtps_http/types_of_source.py,sha256=ucrDpQCXlk6QAqKxCNh_E06H6Hn692u3oTpQ-KuI-ZE,21464
 dtps_http/urls.py,sha256=NmGcqCpanRrco1JhPQGNvn-rLG2jIQ9W7J2G9YyisGQ,4336
 dtps_http/utils.py,sha256=V31fI0dQSMuG5UcWuQZcuSlol9oC92ZonN_bx6REHDI,6139
 dtps_http/utils_every_once_in_a_while.py,sha256=nvZsWa1dnK0i8bSkOciUw-VrLxMpT25QZ6pOcXQICig,838
-dtps_http_programs/__init__.py,sha256=hYcROWKDhb2AMbC3diorM-XXNFYyv3SuwNzhNfjLziw,257
+dtps_http_programs/__init__.py,sha256=tvWIDj0cMOKWr5-LEl9OJw7qmvcePAs9Vv0fZsUrZI0,257
 dtps_http_programs/dtps_listen.py,sha256=2T-CxSAqnC7mdT5AD-bsYqWBggPABefadL_TjxGrBR0,3671
 dtps_http_programs/dtps_proxy.py,sha256=luhDbyOQeFuQOeAXhIB8CjsYhjW8260rHVN2vVWKiTM,1721
 dtps_http_programs/dtps_send_continuous.py,sha256=M4QHRoAUrZ04Rshm11n-g4CUsEeDjvW_UpdRqUHccvo,1338
 dtps_http_programs/dtps_stats.py,sha256=oC8uEjPFhUN1soZ6wkyzmffPPRLuZxrjESsbqfVBN9A,3112
 dtps_http_programs/py.typed,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 dtps_http_programs/server_clock.py,sha256=r7aJJjsXN6Gy26Iy6qw_gs0xQ7RbMlgJBcAhZYFZt7M,1789
-dtps_http_programs/test_hashes.py,sha256=jlM1AvYSSndg07LHyIzRRDIWMXeyR5rHlLg18hGvRwU,1886
-dtps_http_programs/test_memory.py,sha256=pI1W8admZA3k7XpR-7q2R1eCuVUi71jW5A4xkFwUZGA,4682
-dtps_http_programs/test_memory_dashboard.py,sha256=MwdW9yT4wfNYpEzDLi9UaZRUvzuD39gfxbaMKth6YQ8,3267
-dtps_http_programs/test_memory_dashboard_just_push.py,sha256=c2HAhcrR2pUqAeBuBFnOmmxxpfAnoHsy4r912JfH1Zc,2988
-dtps_http_programs/test_memory_use.py,sha256=CguYdI4kYFLj_jRmmzVzFEuBSBWA-zLxZMNAA6S9wt8,5257
 static/favicon.png,sha256=SuoDecEFzJG3RabXtOofSBcIPjDhKVLjFB0UX_LW4tI,1270
 static/send.js,sha256=_dvhwM61lpyrlIDd0-3xeJ59RCPgeLzBcMpeDlNqEms,7885
 static/style.css,sha256=hYKy8n6jh47vqXRg-ljM1x3Ket2rtMhH08TpOIHaW_s,1472
-dtps_http-1.3.1.dist-info/LICENSE.pdf,sha256=V1TBclYda54_miAikuVMwqHoWjwkjHw_yoF2zEqpc_k,75933
-dtps_http-1.3.1.dist-info/METADATA,sha256=yrsSiu0cOgZlljD46vPg_2uRROp2PGNt2n_Ck6YWO3E,1040
-dtps_http-1.3.1.dist-info/WHEEL,sha256=FMvqSimYX_P7y0a7UY-_Mc83r5zkBZsCYPm7Lr0Bsq4,88
-dtps_http-1.3.1.dist-info/entry_points.txt,sha256=0f8h-Ls_gnf01ABr2FNt1iv2hZqrTfchBMIq-hJs6Uc,379
-dtps_http-1.3.1.dist-info/RECORD,,
+dtps_http-1.3.2.dist-info/LICENSE.pdf,sha256=V1TBclYda54_miAikuVMwqHoWjwkjHw_yoF2zEqpc_k,75933
+dtps_http-1.3.2.dist-info/METADATA,sha256=bTe1Doaq4PxuUMuj5ZQJDn2W8CUtIN6_Q8KyG_AmRjA,1040
+dtps_http-1.3.2.dist-info/WHEEL,sha256=FMvqSimYX_P7y0a7UY-_Mc83r5zkBZsCYPm7Lr0Bsq4,88
+dtps_http-1.3.2.dist-info/entry_points.txt,sha256=0f8h-Ls_gnf01ABr2FNt1iv2hZqrTfchBMIq-hJs6Uc,379
+dtps_http-1.3.2.dist-info/RECORD,,
```

